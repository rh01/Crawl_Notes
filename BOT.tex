
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    usepackage{fontspec, xunicode, xltxtra}
	\setmainfont{SumHei}
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{BOT}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{{[}爬蟲實戰{]}
如何撰寫Python爬蟲抓取台灣銀行的牌告匯率?}\label{ux722cux87f2ux5be6ux6230-ux5982ux4f55ux64b0ux5bebpythonux722cux87f2ux6293ux53d6ux53f0ux7063ux9280ux884cux7684ux724cux544aux532fux7387}

    台湾银行网站为 http://rate.bot.com.tw/xrt?Lang=zh-TW

视频为：https://www.youtube.com/watch?v=-c5rrzjsN34

简介：利用pandas爬去牌告汇率，然后生成excel文件

利用谷歌浏览器:

\textbf{chrome -\/-\textgreater{} 检查 -\/-\textgreater{}
Network(监听器)}

    \subsection{传统的requests爬取}\label{ux4f20ux7edfux7684requestsux722cux53d6}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{c+c1}{\PYZsh{} import require module}
         \PY{k+kn}{import} \PY{n+nn}{requests}
         \PY{c+c1}{\PYZsh{} Get request from indentity object website}
         \PY{n}{req} \PY{o}{=} \PY{n}{requests}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{http://rate.bot.com.tw/xrt?Lang=zh\PYZhy{}TW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{print} \PY{n}{req}\PY{o}{.}\PY{n}{text}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
<!DOCTYPE html>

<html lang="zh-TW" class="no-js">

<head>

    <meta charset="utf-8" />

    <title>臺灣銀行牌告匯率</title>

    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">

    <meta name="description" content="臺灣銀行匯率利率黃金牌價查詢">

    <meta name="keywords" content="">

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <meta name="format-detection" content="telephone=no">

        <meta name="robots" content="index,follow" />



    <link rel="icon" tpye="image/x-icon" href="/favicon.ico">

    <link rel="stylesheet" href="/Content/css/font-awesome.min.css">





        <link rel="stylesheet" href="/Content/main.css?2.2.2">

    <style>

        h1 \{

            margin: 0.7em 0 0.5em 0;

        \}



            h1.hero\_\_header \{

                font-size: 30px;

                margin: 10px 0;

            \}



            h1.hero\_\_header\_small \{

                font-size: 26px;

                margin: 12px 0;

            \}



            h1.hero\_\_header\_eng \{

                font-size: 20px;

                margin: -8px 0;

            \}



        .chart-key-value .sp \{

            position: relative;

            top: 2px;

        \}



        body \{

            font-family: 微軟正黑體, Arial, serif;

            font-size: large;

        \}



        select[name=month], select[name=day] \{

            width: 5em;

        \}



        :lang(en-US) \{

            font-family: "Book-Antiqua",微軟正黑體;

        \}



        .display\_none\_print\_show \{

            display: none;

        \}



        .logo\_div \{

            display: none;

        \}



        .form-horizontal \{

            background-color: \#fcf6f5;

            border: 1px solid \#8A0050;

            border-radius: 4px;

        \}



        legend \{

            padding-left: 1em;

        \}



        .dl-horizontal ol li, .dl-horizontal dt, .well ol li, .well p, .well span, .well div \{

            font-size: 16px;

        \}



        .highcharts-button \{

            display: none;

        \}



        .wordwrap \{

            word-break: break-all;

        \}



        .fa \{

            font: normal normal normal 14px/1 FontAwesome !important;

        \}

    </style>

    <style>

      h1.hero\_\_header \{ font-size: 25px; \}

      .dl-horizontal ol \{color: \#0000ff\}

    </style>



    

    <script src="/Scripts/html5shiv.min.js"></script>

    <script src="/Scripts/respond.min.js"></script>



    

    <script src="/Scripts/css3-mediaqueries.js"></script>



    <style>

        .nav\_ctn img \{

            float: left;

        \}

        /* Style The Dropdown Button */

        .dropbtn \{

            background-color: black;

            color: white;

            padding: 12px;

            font-size: 16px;

            cursor: pointer;

            /*margin: 16px 16px 0 0;*/

            margin: 16px 0px 0 0;

            border: 2px solid \#BA5E95;

            border-radius: 7px;

        \}



        /* The container <div> - needed to position the dropdown content */

        .dropdown \{

            position: relative;

            display: inline-block;

        \}



        /* Dropdown Content (Hidden by Default) */

        .dropdown-content \{

            display: none;

            position: absolute;

            right: 0;

            background-color: \#f9f9f9;

            min-width: 160px;

            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);

        \}



            /* Links inside the dropdown */

            .dropdown-content a \{

                color: black;

                padding: 12px 16px;

                text-decoration: none;

                display: block;

            \}



                /* Change color of dropdown links on hover */

                .dropdown-content a:hover \{

                    background-color: \#ba5e95;

                    color: white;

                \}



        /* Show the dropdown menu on hover */

        .dropdown:hover .dropdown-content \{

            display: block;

        \}



        /* Change the background color of the dropdown button when the dropdown content is shown */

        .dropdown:hover .dropbtn \{

            background-color: white;

            color: \#8a0050;

        \}



        /*hasscript*/

        table th.noscript, .noscript \{

            display: none;

        \}



        table td.noscript, .noscript \{

            display: none;

        \}

    </style>



    <noscript>

        <style>

            table th.noscript \{

                display: table-cell;

            \}



            table th.hasscript \{

                display: none;

            \}



            table td.noscript \{

                display: table-cell;

            \}



            table td.hasscript \{

                display: none;

            \}



            .btn.noscript \{

                display: inline-block;

            \}



            .btn.hasscript \{

                display: none;

            \}



            .hasscript-div \{

                display: none;

            \}

        </style>

    </noscript>

</head>

<body class="undefined">

    <div class="page-wrapper">

        <main role="main" class="main">



            <div class="container">

            </div>

            <div class="hero container">

                <nav style="height:inherit;">

                    <div style="height:inherit;width:100\%" class="nav\_ctn">

                        

                        <div class="hidden-print" style="height:inherit; max-height:80px; padding-top: 9px; padding-left: 9px">

                            <image style="height:90\%;" alt="臺灣銀行logo" title="臺灣銀行logo" src="/Content/images/logo.png"></image>

                        </div>

                        <div class="TitleLang">

                            <div class="dropdown\_lang\_Select hidden-print">

                                <div style="float:right">

                                    <select id="lang\_ddl" style="width:100px;" class="lang\_ddl hasscript-div">

                                        <option value="zh-TW">正體中文</option>

                                        <option value="zh-CN">简体中文</option>

                                        <option value="en-US">English</option>

                                    </select>

                                    <noscript>

                                        <ul style="width:80px; text-align:right;">

                                            <li><a href="?Lang=zh-TW">正體中文</a></li>

                                            

                                        </ul>

                                    </noscript>

                                </div>

                            </div>

                            <div class="dropdown\_lang\_CSS">

                                <div style="float:right">

                                    <div class="dropdown dropdown\_lang hasscript-div">

                                        <button class="dropbtn" id="lang\_ddl\_phone">中</button>

                                        <div class="dropdown-content">

                                            <a class="lang\_ddl\_css" value="zh-TW">正體中文</a>

                                            <a class="lang\_ddl\_css" value="zh-CN">简体中文</a>

                                            <a class="lang\_ddl\_css" value="en-US">English</a>

                                        </div>

                                    </div>

                                </div>

                            </div>

                        </div>

                    </div>

                </nav>

            </div>



            <div class="container H1\_div\_ctrl">

                <div class="logo\_div">

                    

                    <image alt="臺灣銀行logo" title="臺灣銀行logo" width="200px" src="/Content/images/logo\_color.png"></image>

                </div>

                        <h1>

                            <span class="logo"></span>

                            <span id="h1\_small\_id" style="color:blue">2017/01/20</span>

                            <span id="h1\_id"><nobr><span style='color:blue'>本行</span><span style='color:red'>營業時間</span><span style='color:blue'>牌告匯率</span></nobr></span>

                        </h1>



            </div>







            



<div class="container">

        <dl class="dl-horizontal" title="注意事項">

            <dt><font color="\#0000ff"><font style="FONT-SIZE\_: 14px; FONT-WEIGHT: bold">\&\#35531;\&\#27880;\&\#24847;\&\#65306;</font> </font></dt>

            <dd>

                <ol>

                        <li><font color="\#0000ff">\&\#26412;\&\#34920;\&\#36039;\&\#26009;\&\#20677;\&\#20379;\&\#21443;\&\#32771;\&\#65292;\&\#19981;\&\#20195;\&\#34920;\&\#23526;\&\#38555;\&\#20132;\&\#26131;\&\#21295;\&\#29575;\&\#12290; </font></li>

                        <li><font color="\#0000ff">\&\#12300;\&\#32178;\&\#36335;\&\#37504;\&\#34892;\&\#12301;\&\#21450;\&\#12300;Easy\&\#36092;\&\#32218;\&\#19978;\&\#30003;\&\#36092;\&\#29694;\&\#37396;\&\#25110;\&\#26053;\&\#25903;\&\#12301;\&\#20043;\&\#23526;\&\#38555;\&\#20132;\&\#26131;\&\#21295;\&\#29575;\&\#65292;\&\#20197;\&\#20132;\&\#26131;\&\#26178;\&\#39023;\&\#31034;\&\#20043;\&\#21295;\&\#29575;\&\#28858;\&\#28310;\&\#12290; </font></li>

                        <li><font color="\#0000ff">\&\#33256;\&\#27331;\&\#23526;\&\#38555;\&\#20132;\&\#26131;\&\#21295;\&\#29575;\&\#20197;\&\#20132;\&\#26131;\&\#26178;\&\#26412;\&\#34892;\&\#21295;\&\#29575;\&\#28858;\&\#28310;\&\#12290; </font></li>

                        <li><font color="\#0000ff">\&\#26412;\&\#32178;\&\#38913;\&\#29260;\&\#21578;\&\#21295;\&\#29575;\&\#36039;\&\#35338;\&\#28858;\&\#38748;\&\#24907;\&\#39023;\&\#31034;\&\#65292;\&\#39023;\&\#31034;\&\#20043;\&\#29260;\&\#21578;\&\#21295;\&\#29575;\&\#36039;\&\#35338;\&\#19981;\&\#26371;\&\#38568;\&\#24460;\&\#32396;\&\#30064;\&\#21205;\&\#32780;\&\#33258;\&\#21205;\&\#26356;\&\#26032;\&\#36039;\&\#35338;\&\#65292;\&\#27442;\&\#24471;\&\#30693;\&\#26412;\&\#34892;\&\#26368;\&\#26032;\&\#29260;\&\#21578;\&\#21295;\&\#29575;\&\#36039;\&\#35338;\&\#35531;\&\#25353;\&\#12300;\&\#21462;\&\#24471;\&\#26368;\&\#26032;\&\#22577;\&\#20729;\&\#12301;\&\#37397;\&\#12290; </font></li>

                </ol>

            </dd>

        </dl>

    <p class="text-right">

        <a class="btn right click\_reload">取得最新報價</a>

        <a href="https://fctc.bot.com.tw/" target="\_blank" class="btn right">線上申購外幣現鈔或旅支</a>

    </p>

    <p class="text-info">

        <span class="fa fa-desktop"></span>

        牌價最新掛牌時間：<span class="time">2017/01/20 16:00</span>

    </p>

    <p id="rate-toggles" class="visible-phone btn-group print\_hide">

        <button type="button" class="rate-toggle-cash active print\_hide btn hasscript-div">現金匯率</button>

        <button type="button" class="rate-toggle-sight print\_hide btn hasscript-div">即期匯率</button>

    </p>

    <table title="牌告匯率" class="table table-striped table-bordered table-condensed table-hover" summary="此表格是牌告匯率，表格分為七直欄，第一直欄是幣別，第二直欄是本行買入現金匯率，第三直欄是本行賣出現金匯率，第四直欄是本行買入即期匯率，第五直欄是本行賣出即期匯率，第六直欄是遠期匯率連結，第七直欄是歷史匯率連結。">

        <thead class="phone-medium-font">

            <tr>

                <th class="print\_width set-title-L-min-width-class noscript" rowspan="2">幣別</th>

                <th class="print\_width rowSP\_Ctrl\_2\_2\_2 set-title-L-min-width-class hasscript ">幣別</th>

                <th class="print\_hide rate-content-cash " colspan="2">現金匯率</th>

                <th class="hidden"></th>

                <th class="print\_hide rate-content-sight " colspan="2">即期匯率</th>

                <th class="hidden"></th>

                <th class="print\_hide" rowspan="2">

                    <span class=""><span>遠期匯率</span></span>

                </th>

                <th class="print\_hide noscript" rowspan="2">歷史匯率</th>

                <th class="print\_hide rowSP\_Ctrl\_2\_2\_2 hasscript ">歷史匯率</th>



                <th class="display\_none\_print\_show print\_width" colspan="2">現金匯率</th>

                <th class="hidden"></th>

                <th class="display\_none\_print\_show print\_width" colspan="2">即期匯率</th>

                <th class="hidden"></th>

            </tr>

            <tr>

                <th class="hidden"></th>

                <th class="rate-content-cash print\_hide">

                    <span style="width:inherit;">

                        <span class="">本行買入</span>

                    </span>

                </th>

                <th class="rate-content-cash print\_hide">

                    <span style="width:inherit;">

                        <span class="">本行賣出</span>

                    </span>

                </th>

                <th class="rate-content-sight print\_hide" data-hide="phone">

                    <span style="width:inherit;">

                        <span class="">本行買入</span>

                    </span>

                </th>

                <th class="rate-content-sight print\_hide" data-hide="phone">

                    <span style="width:inherit;">

                        <span class="">本行賣出</span>

                    </span>

                </th>

                <th class="hidden"></th>



                <th class="display\_none\_print\_show print\_width"><span style="width:inherit;">本行買入</span></th>

                <th class="display\_none\_print\_show print\_width"><span style="width:inherit;">本行賣出</span></th>

                <th class="display\_none\_print\_show print\_width"><span style="width:inherit;">本行買入</span></th>

                <th class="display\_none\_print\_show print\_width"><span style="width:inherit;">本行賣出</span></th>

            </tr>

        </thead>

        <tbody>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-america-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-america-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                美金 (USD)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                美金 (USD)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">31.18</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">31.722</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">31.48</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">31.58</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/USD">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/USD" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">31.18</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">31.722</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">31.48</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">31.58</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-hong-kong-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-hong-kong-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                港幣 (HKD)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                港幣 (HKD)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">3.914</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">4.109</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">4.034</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">4.094</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/HKD">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/HKD" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">3.914</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">4.109</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">4.034</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">4.094</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-england-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-england-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                英鎊 (GBP)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                英鎊 (GBP)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">37.82</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">39.75</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">38.69</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">39.11</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/GBP">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/GBP" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">37.82</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">39.75</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">38.69</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">39.11</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-australia-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-australia-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                澳幣 (AUD)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                澳幣 (AUD)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">23.53</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">24.19</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">23.72</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">23.95</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/AUD">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/AUD" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">23.53</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">24.19</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">23.72</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">23.95</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-canada-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-canada-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                加拿大幣 (CAD)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                加拿大幣 (CAD)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">23.34</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">24.08</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">23.61</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">23.83</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/CAD">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/CAD" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">23.34</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">24.08</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">23.61</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">23.83</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-singapore-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-singapore-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                新加坡幣 (SGD)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                新加坡幣 (SGD)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">21.62</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">22.4</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">22.04</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">22.22</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/SGD">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/SGD" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">21.62</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">22.4</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">22.04</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">22.22</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-swiss-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-swiss-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                瑞士法郎 (CHF)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                瑞士法郎 (CHF)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">30.68</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">31.74</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">31.21</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">31.5</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/CHF">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/CHF" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">30.68</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">31.74</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">31.21</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">31.5</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-japan-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-japan-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                日圓 (JPY)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                日圓 (JPY)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">0.2664</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">0.2774</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">0.2728</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">0.2768</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/JPY">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/JPY" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">0.2664</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">0.2774</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">0.2728</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">0.2768</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-south-africa-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-south-africa-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                南非幣 (ZAR)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                南非幣 (ZAR)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">-</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">-</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">2.29</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">2.37</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/ZAR">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/ZAR" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">-</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">-</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">2.29</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">2.37</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-sweden-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-sweden-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                瑞典幣 (SEK)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                瑞典幣 (SEK)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">3.14</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">3.65</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">3.48</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">3.58</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/SEK">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/SEK" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">3.14</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">3.65</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">3.48</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">3.58</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-new-zealand-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-new-zealand-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                紐元 (NZD)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                紐元 (NZD)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">22.34</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">22.97</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">22.58</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">22.78</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/NZD">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/NZD" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">22.34</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">22.97</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">22.58</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">22.78</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-thailand-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-thailand-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                泰幣 (THB)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                泰幣 (THB)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">0.7886</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">0.9316</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">0.8771</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">0.9171</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/THB">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/THB" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">0.7886</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">0.9316</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">0.8771</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">0.9171</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-philippine-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-philippine-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                菲國比索 (PHP)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                菲國比索 (PHP)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">0.5826</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">0.7156</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">-</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">-</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/PHP">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/PHP" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">0.5826</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">0.7156</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">-</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">-</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-indonesia-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-indonesia-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                印尼幣 (IDR)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                印尼幣 (IDR)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">0.00198</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">0.00268</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">-</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">-</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/IDR">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/IDR" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">0.00198</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">0.00268</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">-</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">-</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-euro-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-euro-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                歐元 (EUR)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                歐元 (EUR)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">32.96</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">34.11</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">33.46</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">33.86</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/EUR">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/EUR" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">32.96</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">34.11</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">33.46</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">33.86</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-korea-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-korea-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                韓元 (KRW)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                韓元 (KRW)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">0.02518</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">0.02908</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">-</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">-</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/KRW">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/KRW" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">0.02518</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">0.02908</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">-</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">-</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-vietnam-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-vietnam-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                越南盾 (VND)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                越南盾 (VND)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">0.00102</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">0.00152</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">-</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">-</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/VND">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/VND" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">0.00102</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">0.00152</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">-</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">-</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-malaysia-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-malaysia-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                馬來幣 (MYR)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                馬來幣 (MYR)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">6.006</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">7.606</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">-</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">-</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/MYR">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/MYR" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">6.006</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">7.606</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">-</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">-</td>

                </tr>

                <tr>

                    <td data-table="幣別" class="currency phone-small-font">

                        <div>

                            <div class="sp-div sp-china-div">

                                <img title="幣別國旗" alt="幣別國旗" src="/Content/images/sprite\_lateral.png" class="sp-img sp-china-img" />

                            </div>

                            <br class="visible-phone print\_hide" />

                            <div class="visible-phone print\_hide">

                                人民幣 (CNY)

                            </div>

                            <div class="hidden-phone print\_show" style="text-indent:30px;">

                                人民幣 (CNY)

                            </div>

                        </div>

                    </td>

                    <td data-table="本行現金買入" class="rate-content-cash text-right print\_hide">4.51</td>

                    <td data-table="本行現金賣出" class="rate-content-cash text-right print\_hide">4.672</td>

                    <td data-table="本行即期買入" class="rate-content-sight text-right print\_hide" data-hide="phone">4.582</td>

                    <td data-table="本行即期賣出" class="rate-content-sight text-right print\_hide" data-hide="phone">4.632</td>

                    <td data-table="遠期匯率買入/賣出" class="text-center print\_hide phone-small-font"><a href="/xrt/forward/CNY">查詢</a></td>

                    <td data-table="歷史匯率" class="text-center print\_hide phone-small-font"><a href="/xrt/history/CNY" target="\_blank">查詢</a></td>

                    <td data-table="本行現金買入" class="text-right display\_none\_print\_show print\_width">4.51</td>

                    <td data-table="本行現金賣出" class="text-right display\_none\_print\_show print\_width">4.672</td>

                    <td data-table="本行即期買入" class="text-right display\_none\_print\_show print\_width">4.582</td>

                    <td data-table="本行即期賣出" class="text-right display\_none\_print\_show print\_width">4.632</td>

                </tr>

        </tbody>

    </table>

    <div class="text-center">

        <div class="btn-group">

            <a class="btn" href="/xrt/fltxt/0/day">下載文字檔</a>

            <a class="btn" href="/xrt/flcsv/0/day">下載 Excel 檔</a>

            <button type="button" class="btn click\_print">列印本頁</button>

            <button type="button" class="btn click\_close">關閉本頁</button>

        </div>

    </div>

    <noscript>

        <ul>

            <li>列印本頁請按Ctrl + P</li>

            <li>關閉本頁請按Ctrl + W</li>

            <li>取得新報價請按F5</li>

        </ul>

    </noscript>

</div>

            <div class="container doPrintDiv" style="display:none;">

                <button class="btn doPrintBtn" style="display:none">

                    列印本頁

                </button>

                <button class="btn doCloseBtn" style="display:none">

                    關閉本頁

                </button>

            </div>

            

            



            

        </main>

    </div>

    <div class="text-center">

        <br>

        <svg class="icon icon-facebook" style="width: 2em; height: 2em">

            <use xlink:href="\#icon-facebook"></use>

        </svg>

        <svg class="icon icon-twitter" style="width: 2em; height: 2em">

            <use xlink:href="\#icon-twitter"></use>

        </svg>

    </div>

    <script>

        if (!Function.prototype.bind) \{

            Function.prototype.bind = function (oThis) \{

                if (typeof this !== 'function') \{

                    // closest thing possible to the ECMAScript 5

                    // internal IsCallable function

                    throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');

                \}



                var aArgs = Array.prototype.slice.call(arguments, 1),

                    fToBind = this,

                    fNOP = function () \{ \},

                    fBound = function () \{

                        return fToBind.apply(this instanceof fNOP \&\& oThis

                               ? this

                               : oThis,

                               aArgs.concat(Array.prototype.slice.call(arguments)));

                    \};



                fNOP.prototype = this.prototype;

                fBound.prototype = new fNOP();



                return fBound;

            \};

        \}

    </script>

            <script src="/Scripts/main-local.js"></script>

    <script>

        var controller = 'xrt'.toLowerCase();

        //window.onunload = function () \{ \};



        //停用 Row Toggle 功能

        function footable\_off() \{

            \$('.footable tr').off();

            \$('.footable td').off();

        \}

        //判斷是否含中文

        function isChinese(str) \{

            var patrn = /[\textbackslash{}u4e00-\textbackslash{}u9fff]/gi;

            if (patrn.exec(str)) \{

                return true;

            \}

            else \{

                return false;

            \}

        \}

        var h1\_size\_from\_css = 28;//parseInt(\$("\#h1\_id").css('font-size'));

        //自適應H1大小

        function minsize() \{

            if (\$("\#h1\_id").width() > \$(".container").width()) \{

                var oldH1size = parseFloat(\$("\#h1\_id").css('font-size'));

                var h1size = (oldH1size - 1).toString() + "px";

                \$("\#h1\_id").css('font-size', h1size);

                \$("\#h1\_small\_id").css('font-size', h1size);

                //app px \& pt fix

                if (parseFloat(\$("\#h1\_id").css('font-size')) > oldH1size) \{

                    \$("\#h1\_id").css('font-size', ((oldH1size - 1) / 1.73).toString() + "px");

                    \$("\#h1\_small\_id").css('font-size', ((oldH1size - 1) / 1.73).toString() + "px");

                \}

            \} else if (\$("\#h1\_id").width() < \$(".container").width()) \{

                if (parseInt(\$("\#h1\_id").css('font-size')) < h1\_size\_from\_css) \{

                    \$("\#h1\_id").css('font-size', parseInt(\$("\#h1\_id").css('font-size')) + 1 + 'px');

                    \$("\#h1\_small\_id").css('font-size', parseInt(\$("\#h1\_small\_id").css('font-size')) + 1 + 'px');

                \}

            \} else \{



            \}

        \}

        var h1\_margin\_from\_css = \$(".hero\_\_header").css("margin");

        function setH1Size() \{

            var H1\_Str = "[blue]本行[/blue][red]營業時間[/red][blue]牌告匯率[/blue]";

            if (isChinese(H1\_Str)) \{

                //中文不破版縮小\&放大

                for (var i = 1; i < 10; i++) \{

                    window.setTimeout(function () \{

                        minsize();

                    \}, 1 * i);

                \}

            \} else \{

                //英文版防破版

                //\$("th").addClass("wordwrap");

                //\$("td").addClass("wordwrap");



                //英文遇換行調整字高

                //line-height

                //if (\$("\#h1\_id").height() > 35) \{

                //    \$(".hero\_\_header").css("margin", "-10px 0");

                //\} else \{

                //    \$(".hero\_\_header").css("margin", h1\_margin\_from\_css);

                //\}

            \}

        \}



        //設定說明標籤高\&文字置中

        function setRowChartKeyValuesMaxHeight() \{

            \$('div.chart-key-value').each(function () \{

                \$(this).find(".key").css("height", "");

                \$(this).find(".value").css("height", "");

                \$(this).find(".key").css("line-height", "");

                \$(this).find(".value").css("line-height", "");

            \})



            var window\_width = \$(window).width();

            if (window\_width <= 750) \{

                //小版型：分開看，value高決定key高

                \$("div.chart-key-value").each(function () \{

                    if (\$(this).find(".key").height() > \$(this).find(".value").height()) \{

                        \$(this).find(".value").height(\$(this).find(".key").height() + "px");

                        \$(this).find(".value").css("line-height", \$(this).find(".key").height() + "px");

                    \} else \{

                        \$(this).find(".key").height(\$(this).find(".value").height() + "px");

                        \$(this).find(".key").css("line-height", \$(this).find(".value").height() + "px");

                    \}

                \});

            \} else \{

                //大版型：一起看，高統一看最高的

                var key\_value\_highest = 0;

                //找出最高

                \$('div.chart-key-value').each(function () \{

                    if (\$(this).find(".key").height() > key\_value\_highest) \{

                        key\_value\_highest = \$(this).find(".key").height();

                    \}

                    if (\$(this).find(".value").height() > key\_value\_highest) \{

                        key\_value\_highest = \$(this).find(".value").height();

                    \}

                \})



                \$('div.chart-key-value').each(function () \{

                    if (\$(this).find(".key").height() != key\_value\_highest) \{

                        var key\_value\_height = 32 * (key\_value\_highest / \$(this).find(".key").height());

                        \$(this).find(".key").css("line-height", key\_value\_height + "px");

                    \}

                    if (\$(this).find(".value").height() != key\_value\_highest) \{

                        var key\_value\_height = 32 * (key\_value\_highest / \$(this).find(".value").height());

                        \$(this).find(".value").css("line-height", key\_value\_height + "px");

                    \}

                    \$(this).find(".key").height(key\_value\_highest + "px");

                    \$(this).find(".value").height(key\_value\_highest + "px");

                \});

            \}

        \}



        function blurcommafy(num) \{

            if (num.split(".").length == 1) \{

                num = commafy(num);

            \} else if (num.split(".").length == 2) \{

                //小數部份不用加千分位

                num = commafy(num.split(".")[0]) + "." + num.split(".")[1];

            \}

            return num;

        \}



        //加上千分位

        function commafy(num) \{

            num = num + "";

            var re = /(-?\textbackslash{}d+)(\textbackslash{}d\{3\})/

            while (re.test(num)) \{

                num = num.replace(re, "\$1,\$2")

            \}

            return num;

        \}

        //移除千分位

        function removeCommafy(num) \{

            return num.replace(/[,]+/g, "");

        \}



        //RWD加入千分位

        function tableAddCommafy() \{

            \$(".table > tbody > tr > td").each(function () \{

                var td = \$(this).text();

                if (!isNaN(td)) \{

                    if (td.split(".").length == 1) \{

                        \$(this).text(commafy(td));

                    \} else if (td.split(".").length == 2) \{

                        //小數部份不用加千分位

                        \$(this).text(commafy(td.split(".")[0]) + "." + td.split(".")[1]);

                    \}

                \}

            \})

        \}



        //小數尾去0

        function removeTableDoubleZero() \{

            \$(".table > tbody > tr > td").each(function () \{

                var td = \$(this).text();

                if (!isNaN(td)) \{

                    if (td.split(".").length == 1) \{

                        \$(this).text(commafy(td));

                    \} else if (td.split(".").length == 2) \{

                        //小數部份不用加千分位

                        //小數尾去0

                        if (td.split(".")[1].replace(/0+\$/, '') == "") \{

                            \$(this).text(commafy(td.split(".")[0]));

                        \} else \{

                            \$(this).text(commafy(td.split(".")[0]) + "." + td.split(".")[1].replace(/0+\$/, ''));

                        \}

                    \}

                \}

            \})

        \}



        //判斷瀏覽器類型

        function detectBrowser() \{

            var Sys = \{\};

            var ua = navigator.userAgent.toLowerCase();

            var s;

            (s = ua.match(/rv:([\textbackslash{}d.]+)\textbackslash{}) like gecko/)) ? Sys.ie = s[1] :

            (s = ua.match(/msie ([\textbackslash{}d.]+)/)) ? Sys.ie = s[1] :

            (s = ua.match(/firefox\textbackslash{}/([\textbackslash{}d.]+)/)) ? Sys.firefox = s[1] :

            (s = ua.match(/chrome\textbackslash{}/([\textbackslash{}d.]+)/)) ? Sys.chrome = s[1] :

            (s = ua.match(/opera.([\textbackslash{}d.]+)/)) ? Sys.opera = s[1] :

            (s = ua.match(/version\textbackslash{}/([\textbackslash{}d.]+).*safari/)) ? Sys.safari = s[1] : 0;



            if (Sys.ie) return "IE";

            if (Sys.firefox) return "Firefox";

            if (Sys.chrome) return "Chrome";

            if (Sys.opera) return "Opera";

            if (Sys.safari) return "Safari";

        \}



        //xrt/all頁面table 第一行 th 隱藏

        function hideTableTh() \{

            var all\_width = \$(window).width();//console.log(all\_width);

            if (all\_width < 980) \{

                \$(".tablet\_hide").hide();

            \} else \{

                \$(".tablet\_hide").show();

            \}



            if (all\_width < 480) \{

                \$(".phone\_hide").hide();

            \} else \{

                \$(".phone\_hide").show();

            \}

        \}



        //設定語系位置

        function setTitleLangDiv() \{

            //ie8不使用 其他要用

            if (!-[1, ]) \{

                \$(".TitleLang").addClass("TitleLangDivIE");

            \}

            else \{

                \$(".TitleLang").addClass("TitleLangDiv");

            \}

        \}



        //寬小於768px的手機 TABLE靠邊貼齊

        //這邊一定要用class指定，不可直接用table，不然emarketing進來的table也會被動到，造成手機版破版。

        function setTableWidthInMiniPhone() \{

            var window\_width = \$(window).width();

            if (window\_width <= 767) \{

                \$(".table").css("width", window\_width - 2);

                \$(".table").css("margin-right", "-20px");

                \$(".table").css("margin-left", "-20px");

            \} else \{

                \$(".table").css("width", "");

                \$(".table").css("margin-right", "");

                \$(".table").css("margin-left", "");

            \}

        \}



        //加上列印style

        function setPrintStyle() \{



            /*main.css*/

            \$(".visible-print").show();

            \$(".hidden-print").hide();

            \$("blockquote").css("page-break-inside", "avoid");

            \$("img").css("page-break-inside", "avoid");

            \$("pre").css("page-break-inside", "avoid");

            \$("tr").css("page-break-inside", "avoid");

            //\$("*").css(\{

            //    "background": "0 0 !important",

            //"color": "\#000 !important",

            //"box-shadow": "none !important",

            //"text-shadow": "none !important"

            //\});

            \$("a").css("text-decoration", "underline");

            \$("a:visited").css("text-decoration", "underline");

            \$("abbr[title]:after").css("content", "' (' attr(title) ')'");

            \$(".ir a:after").css("content", "");

            \$("a[href\^{}='javascript:']:after").css("content", "");

            \$("a[href\^{}='\#']:after").css("content", "");

            \$("blockquote").css("border", "1px solid \#999");

            \$("pre").css("border", "1px solid \#999");

            \$("thead").css("display", "table-header-group");

            \$("img").css("max-width", "100\% !important");



            //\$("@page").css(\{

            //    "size": "A4",

            //"margin": ".5cm"

            //\});

            \$("h2").css(\{

                "orphans": "3",

                "widows": "3"

            \});

            \$("h3").css(\{

                "orphans": "3",

                "widows": "3"

            \});

            \$("p").css(\{

                "orphans": "3",

                "widows": "3"

            \});

            \$(".H1\_div\_ctrl").show();

            \$("h2").css("page-break-after", "avoid");

            \$("h3").css("page-break-after", "avoid");



            /*\_layout*/

            \$(".display\_none\_print\_show").show();

            \$(".print\_hide").hide();

            \$(".logo\_div").show();

            \$(".logo\_div").css("margin-top", "-3em");

            \$(".dl-horizontal").hide();

            \$("dropdown").hide();

            \$(".dropbtn").hide();

            \$(".btn").hide();

            \$("table.table").css("border", "1px solid black !important");

            \$("table").css("border", "1px solid black !important");

            \$(".table th").css("border", "1px solid black !important");

            \$("th").css("border", "1px solid black !important");

            \$(".table td").css("border", "1px solid black !important");

            \$("td").css("border", "1px solid black !important");

            \$(".phone-unset-font").css("font-size", "large !important");

            \$(".phone-small-font").css("font-size", "large !important");



            \$(".nav\_ctn").hide();

            \$(".hero").css("background-color", "white");

            \$(".hero").css("background-image", "linear-gradient(to right,white,white)");



            \$(".doPrintDiv").show();

            \$(".doPrintBtn").show();

            \$(".doCloseBtn").show();

        \}



        /// 檢查輸入的日期是否是一個正確的日期格式：

        /// 支持 yyyy-M-d、yyyy-MM-dd、yyyy/M/d、yyyy/MM/dd 四種輸入格式。

        function CheckDate(strInputDate) \{

            if (strInputDate == "")

                return false;

            strInputDate = strInputDate.replace(/-/g, "/");

            var d = new Date(strInputDate);

            if (isNaN(d))

                return false;

            var arr = strInputDate.split("/");

            return ((parseInt(arr[0], 10) == d.getFullYear()) \&\& (parseInt(arr[1], 10) == (d.getMonth() + 1)) \&\& (parseInt(arr[2], 10) == d.getDate()));

        \}



        //比較幣別 防呆xrt/history xrt/obuhx 不可比較自己

        function onCurrencySelectChange() \{

            \$("select[name='compare'] span").each(function () \{

                \$(this).showOption();

            \})

            \$("select[name='compare'] option").each(function () \{

                if (\$(this).val() == \$("select[name='currency']").val()) \{

                    \$(this).hideOption();

                \}

            \})

        \}



        \$.fn.hideOption = function () \{

            var text = \$(this).text(), val = this.value, span =

            \$('<span/>').text(text).val(val).hide()



            var old = \$(this).clone();

            \$(this).replaceWith(span)

            \$(span).data('ref', old);

        \}



        \$.fn.showOption = function () \{

            if (\$(this).data('ref'))

                \$(this).replaceWith(\$(this).data('ref'))

        \}

        window.mobileAndTabletcheck = function () \{

            var check = false;

            (function (a) \{ if (/(android|bb\textbackslash{}d+|meego).+mobile|avantgo|bada\textbackslash{}/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\textbackslash{}/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\textbackslash{}.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\textbackslash{}-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\textbackslash{}-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\textbackslash{}-(n|u)|c55\textbackslash{}/|capi|ccwa|cdm\textbackslash{}-|cell|chtm|cldc|cmd\textbackslash{}-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\textbackslash{}-s|devi|dica|dmob|do(c|p)o|ds(12|\textbackslash{}-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\textbackslash{}-|\_)|g1 u|g560|gene|gf\textbackslash{}-5|g\textbackslash{}-mo|go(\textbackslash{}.w|od)|gr(ad|un)|haie|hcit|hd\textbackslash{}-(m|p|t)|hei\textbackslash{}-|hi(pt|ta)|hp( i|ip)|hs\textbackslash{}-c|ht(c(\textbackslash{}-| |\_|a|g|p|s|t)|tp)|hu(aw|tc)|i\textbackslash{}-(20|go|ma)|i230|iac( |\textbackslash{}-|\textbackslash{}/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\textbackslash{}/)|klon|kpt |kwc\textbackslash{}-|kyo(c|k)|le(no|xi)|lg( g|\textbackslash{}/(k|l|u)|50|54|\textbackslash{}-[a-w])|libw|lynx|m1\textbackslash{}-w|m3ga|m50\textbackslash{}/|ma(te|ui|xo)|mc(01|21|ca)|m\textbackslash{}-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\textbackslash{}-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\textbackslash{}-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\textbackslash{}-([1-8]|c))|phil|pire|pl(ay|uc)|pn\textbackslash{}-2|po(ck|rt|se)|prox|psio|pt\textbackslash{}-g|qa\textbackslash{}-a|qc(07|12|21|32|60|\textbackslash{}-[2-7]|i\textbackslash{}-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\textbackslash{}/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\textbackslash{}-|oo|p\textbackslash{}-)|sdk\textbackslash{}/|se(c(\textbackslash{}-|0|1)|47|mc|nd|ri)|sgh\textbackslash{}-|shar|sie(\textbackslash{}-|m)|sk\textbackslash{}-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\textbackslash{}-|v\textbackslash{}-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\textbackslash{}-|tdg\textbackslash{}-|tel(i|m)|tim\textbackslash{}-|t\textbackslash{}-mo|to(pl|sh)|ts(70|m\textbackslash{}-|m3|m5)|tx\textbackslash{}-9|up(\textbackslash{}.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\textbackslash{}-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\textbackslash{}-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\textbackslash{}-|your|zeto|zte\textbackslash{}-/i.test(a.substr(0, 4))) check = true; \})(navigator.userAgent || navigator.vendor || window.opera);

            return check;

        \};

        if (mobileAndTabletcheck()) \{

            \$('.click\_print').hide();

        \}

        // Read a page's GET URL variables and return them as an associative array.

        function getUrlVars() \{

            var vars = [], hash;

            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('\&');

            for (var i = 0; i < hashes.length; i++) \{

                hash = hashes[i].split('=');

                vars.push(hash[0]);

                vars[hash[0]] = hash[1];

            \}

            return vars;

        \}



        function getBreakPointType\_5types(width) \{

            if (width < 480) \{

                return "phone"

            \} else if (width >= 480 \&\& width < 600) \{

                return "tablet"

            \} else if (width >= 600 \&\& width < 940) \{

                return "default600"

            \} else if (width >= 940 \&\& width < 1170) \{

                return "default940"

            \} else \{

                //return "default1170"

                return "default"

            \}

        \}



        //最近一個營業日不可比較幣別，比較幣別為空時不顯示現金\&即期

        function search\_range\_check(search\_range) \{

            if (search\_range.val() == 'ltm' || search\_range.val() == 'month' || search\_range.val() == 'l6m' || search\_range.val() == 'l1y' || search\_range.val() == 'l3y') \{

                \$('select[name=compare]').prop('disabled', false);

                if (\$('select[name=compare]').val()) \{ \$('\#datatype').show(); \} else \{

                    \$('\#datatype').hide();

                \}

            \} else \{

                \$('select[name=compare]').val('');

                \$('select[name=compare]').prop('disabled', 'disabled');

                \$('\#datatype').hide();

            \}

        \}



        //function onpageshowFn() \{

        //    //最近一個營業日不可比較幣別，比較幣別為空時不顯示現金\&即期(for chrome)

        //    //search\_range\_check(\$('input:radio:checked[name="search\_range"]'));

        //\}



        //去footable上面多的線\&下面多的線

        function footableHideNodataBottom() \{

            \$(".footable-row-detail-row").each(function () \{

                if (\$(this).find("div.footable-row-detail-name").html() == "") \{

                    \$(this).hide();

                \}

            \})

            \$(".footable-row-detail-row:last-child").css("border-bottom", "0px \#ddd solid");

        \}



        //去除url中lang參數

        function removeUrlLang(urlSearch) \{

            urlSearch = urlSearch.replace("?Lang=zh-TW\&", "").replace("?Lang=en-US\&", "").replace("?Lang=zh-CN\&", "");

            urlSearch = urlSearch.replace("?Lang=zh-TW", "").replace("?Lang=en-US", "").replace("?Lang=zh-CN", "");



            urlSearch = urlSearch.replace("?lang=zh-TW\&", "").replace("?lang=en-US\&", "").replace("?lang=zh-CN\&", "");

            urlSearch = urlSearch.replace("?lang=zh-TW", "").replace("?lang=en-US", "").replace("?lang=zh-CN", "");



            urlSearch = urlSearch.replace("?", "");

            if (urlSearch != "") \{

                return "\&" + urlSearch;

            \} else \{

                return urlSearch;

            \}

        \}



        //觸發多語系連結

        function ChangeLanguage(lang) \{

            switch (lang) \{

                case "zh-TW" || "zh-tw":

                    if (location.search == "") \{

                        window.location.href = location.pathname + "?Lang=zh-TW";

                    \} else \{

                        window.location.href = location.pathname + "?Lang=zh-TW" + removeUrlLang(location.search);

                    \}

                    break;

                case "zh-CN" || "zh-cn":

                    if (location.search == "") \{

                        window.location.href = location.pathname + "?Lang=zh-CN";

                    \} else \{

                        window.location.href = location.pathname + "?Lang=zh-CN" + removeUrlLang(location.search);

                    \}

                    break;

                case "en-US" || "en-us":

                    if (location.search == "") \{

                        window.location.href = location.pathname + "?Lang=en-US";

                    \} else \{

                        window.location.href = location.pathname + "?Lang=en-US" + removeUrlLang(location.search);

                    \}

                    break;

            \}

        \}



        //xrt/obuhx查詢畫面title等高判定

        function setFormTitleHigh() \{

            if (\$('.container').width() > 768) \{

                \$(".queryForm1 > fieldset > legend").height(40.2);

                if (\$(".queryForm1 > fieldset > legend").height() > \$(".queryForm2 > fieldset > legend").height()) \{

                    \$(".queryForm2 > fieldset > legend").height(\$(".queryForm1 > fieldset > legend").height());

                \} else if (\$(".queryForm1 > fieldset > legend").height() < \$(".queryForm2 > fieldset > legend").height()) \{

                    \$(".queryForm1 > fieldset > legend").height(\$(".queryForm2 > fieldset > legend").height());

                \}

            \} else \{

                \$(".queryForm1 > fieldset > legend").css("height", "");

                \$(".queryForm2 > fieldset > legend").css("height", "");

            \}

        \}



        //cr/手機版rwd表格高調整

        function setTableTitleHigh() \{

            if (\$("tr.colstr th:eq(0)").height() > \$("tr.colstr th:eq(1)").height()) \{

                \$("tr.colstr th:eq(1)").height(\$("tr.colstr th:eq(0)").height());

            \} else if (\$("tr.colstr th:eq(0)").height() < \$("tr.colstr th:eq(1)").height()) \{

                \$("tr.colstr th:eq(0)").height(\$("tr.colstr th:eq(1)").height());

            \}

            //console.log(\$('.container').width());

            if (\$('.container').width() > 460) \{

                \$("table tbody tr").each(function () \{

                    \$(this).find("td:eq(1)").css("height", "");

                    \$(this).find("td:eq(3)").css("height", "");

                \})

            \} else \{

                window.setTimeout(function () \{

                    \$("table tbody tr").each(function () \{

                        \$(this).find("td:eq(1)").height(\$(this).find("td:eq(0)").height());

                        \$(this).find("td:eq(3)").height(\$(this).find("td:eq(2)").height());

                    \})

                \}, 100);

            \}



        \}



        \$(document).ready(function () \{

            var body\_width = \$("body").width();

            var container\_width = \$('.container').width();

            //ie加入logo

            if (!-[1, ]) \{

                \$(".main > div.hero > nav > div > a").hide();

                \$(".page-wrapper > main > div.hero").css("height", "100px");

            \}



            //自適應H1大小

            setH1Size();



            //設定說明標籤高\&文字置中

            setRowChartKeyValuesMaxHeight();



            //寬小於768px的手機 TABLE靠邊貼齊

            setTableWidthInMiniPhone()



            //設定語系位置

            setTitleLangDiv();



            \$(window).resize(function () \{

                setH1Size();

                if (controller == 'xrt') \{

                    //xrt/all頁面table 第一行 th 隱藏

                    hideTableTh();

                    //xrt/obuhx查詢畫面title等高判定

                    setFormTitleHigh();

                \}



                if (controller == 'cr') \{

                    //cr/手機版rwd表格高調整

                    setTableTitleHigh();

                \}



                if (controller == 'use') \{

                    //use/手機版rwd表格高調整

                    setTableTitleHigh();

                \}



                //設定說明標籤高\&文字置中

                setRowChartKeyValuesMaxHeight();



                //寬小於768px的手機 TABLE靠邊貼齊

                setTableWidthInMiniPhone();

            \});



            //Trial

            if (controller == 'trial') \{

                \$("\#lang\_ddl").hide();

                \$(".TitleLang").hide();



                \$("input:radio").width("12px");

                \$("div.trailer > span.input-append > input:text").width("40px");

                //JavaScript 鎖右鍵

                document.oncontextmenu = new Function("return false");



                \$(".trailer").css("line-height", "45px");

                \$(".trailer").css("line-height", "0");

            \}



            // 動態功能

            if (controller == 'ir') \{

                // Bind

                \$('.footable').bind('footable\_breakpoint', function (e) \{

                    // 展開所有表格內容

                    \$('.footable').trigger('footable\_expand\_all');

                    // 依事件動態合併儲存格

                    var breakpoint;

                    if (\$(this).hasClass('phone')) breakpoint = 'phone';

                    else if (\$(this).hasClass('tablet')) breakpoint = 'tablet';

                    else breakpoint = 'default';



                    if (breakpoint == 'phone') \{

                        \$("td[class\^{}='rowSP\_Ctrl\_']").removeAttr('rowspan');

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '4');

                        \$('.rowSP\_Ctrl\_3\_6\_6').attr('rowspan', '6');

                        \$('.rowSP\_Ctrl\_0\_2\_2').attr('rowspan', '2');

                        \$('.rowSP\_Ctrl\_0\_0\_2').attr('rowspan', '2');

                        \$('.set-title-L-min-width-class').css("min-width", parseInt(\$('.container').css("width")) / 5 + "px");

                        \$('.set-title-R-min-width-class').css("min-width", parseInt(\$('.container').css("width")) / 2 + "px");

                    \}

                    else if (breakpoint == 'tablet') \{

                        \$("td[class\^{}='rowSP\_Ctrl\_']").removeAttr('rowspan');

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '4');

                        \$('.rowSP\_Ctrl\_3\_6\_6').attr('rowspan', '6');

                        \$('.rowSP\_Ctrl\_0\_2\_2').attr('rowspan', '2');

                        \$('.set-title-L-min-width-class').css("min-width", parseInt(\$('.container').css("width")) / 5 + "px");

                        \$('.set-title-R-min-width-class').css("min-width", parseInt(\$('.container').css("width")) / 2 + "px");

                    \}

                    else if (breakpoint == 'default') \{

                        \$("td[class\^{}='rowSP\_Ctrl\_']").removeAttr('rowspan');

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '2');

                        \$('.rowSP\_Ctrl\_3\_6\_6').attr('rowspan', '3');



                        //線條

                        \$(".footable-row-detail").hide();

                    \}



                    // 停用 Row Toggle 功能

                    \$('.footable tr').off();

                    \$('.footable td').off();

                    \$('.title\_sp').attr('rowspan', '2');

                \});

                // Trigger Event

                \$('.footable').trigger('footable\_breakpoint');



                //去footable上面多的線\&下面多的線

                footableHideNodataBottom();



                //小數尾去0

                removeTableDoubleZero();

            \}

            if (controller == 'gold') \{

                // Bind

                \$('.footable').bind('footable\_breakpoint', function (e) \{

                    \$("td[class\^{}='rowSP\_Ctrl\_']").removeAttr('rowspan');

                    \$(".rowSP\_Ctrl\_hidden").show();

                    // 展開所有表格內容

                    \$(this).trigger('footable\_expand\_all');

                    // 依事件動態合併儲存格

                    var breakpoint;

                    if (\$(this).hasClass('phone'))

                        breakpoint = 'phone';

                    else if (\$(this).hasClass('tablet'))

                        breakpoint = 'tablet';

                    else breakpoint = 'default';

                    if (breakpoint == 'phone') \{

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '4');

                        \$('.rowSP\_Ctrl\_3\_6\_6').attr('rowspan', '6');

                        \$('.rowSP\_Ctrl\_0\_2\_2').attr('rowspan', '2');

                        \$('.rowSP\_Ctrl\_0\_0\_2').attr('rowspan', '2');

                    \}

                    else if (breakpoint == 'tablet') \{

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '4');

                        \$('.rowSP\_Ctrl\_3\_6\_6').attr('rowspan', '6');

                        \$('.rowSP\_Ctrl\_0\_2\_2').attr('rowspan', '2');

                        \$('.rowSP\_Ctrl\_0\_2\_2').remove

                    \}

                    else if (breakpoint == 'default') \{

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '2');

                        \$('.rowSP\_Ctrl\_3\_6\_6').attr('rowspan', '3');

                        //線條

                        \$(".footable-row-detail").hide();

                    \}



                    // 停用 Row Toggle 功能

                    window.setTimeout(function () \{

                        footable\_off();

                    \}, 1000);



                    //去footable上面多的線\&下面多的線

                    footableHideNodataBottom();



                    \$(".rowSP\_Ctrl\_hidden").hide();

                    \$('.title\_sp').attr('rowspan', '2').attr('colspan', '2');



                    var all\_width = \$(".container").width();

                    if (all\_width > 414) \{

                        \$('.set-title-L').css("width", all\_width * 0.4 + "px");

                        \$('.set-title-R').css("width", all\_width * 0.6 + "px");

                        \$('.set-title-L-min-width-class').css("width", all\_width * 0.2 + "px");

                        \$('.set-title-R-min-width-class').css("width", all\_width * 0.2 + "px");

                    \} else \{

                        \$('.set-title-L').css("width", all\_width * 0.3 + "px");

                        \$('.set-title-R').css("width", all\_width * 0.7 + "px");

                        \$('.set-title-L-min-width-class').css("width", all\_width * 0.15 + "px");

                        \$('.set-title-R-min-width-class').css("width", all\_width * 0.15 + "px");

                    \}



                    \$('.set-title-L-min-width-class').css("min-width", "82px");

                    \$('.set-title-R-min-width-class').css("min-width", "82px");

                \});

                // Trigger Event

                \$('.footable').trigger('footable\_breakpoint');



                //resize時改變欄寬

                \$('.footable').bind('footable\_resize', function (e) \{

                    var all\_width = \$(".container").width();



                    if (all\_width > 414) \{

                        \$('.set-title-L').css("width", all\_width * 0.4 + "px");

                        \$('.set-title-R').css("width", all\_width * 0.6 + "px");

                        \$('.set-title-L-min-width-class').css("width", all\_width * 0.2 + "px");

                        \$('.set-title-R-min-width-class').css("width", all\_width * 0.2 + "px");

                    \} else \{

                        \$('.set-title-L').css("width", all\_width * 0.3 + "px");

                        \$('.set-title-R').css("width", all\_width * 0.7 + "px");

                        \$('.set-title-L-min-width-class').css("width", all\_width * 0.15 + "px");

                        \$('.set-title-R-min-width-class').css("width", all\_width * 0.15 + "px");

                    \}



                    \$('.set-title-L-min-width-class').css("min-width", "85px");

                    \$('.set-title-R-min-width-class').css("min-width", "85px");



                    //去footable上面多的線\&下面多的線

                    footableHideNodataBottom();

                \});

            \}

            if (controller == 'twd') \{

                // Bind

                \$('.footable').bind('footable\_breakpoint', function (e) \{

                    \$("td[class\^{}='rowSP\_Ctrl\_']").removeAttr('rowspan');

                    \$(".rowSP\_Ctrl\_hidden").show();

                    // 展開所有表格內容

                    \$('.footable').trigger('footable\_expand\_all');

                    // 依事件動態合併儲存格

                    var breakpoint;

                    if (\$(this).hasClass('phone')) breakpoint = 'phone';

                    else if (\$(this).hasClass('tablet')) breakpoint = 'tablet';

                    else breakpoint = 'default';



                    if (breakpoint == 'phone') \{

                        \$('.rowSP\_Ctrl\_0\_2\_2').attr('rowspan', '2');

                        \$('.rowSP\_Ctrl\_6\_12\_12').attr('rowspan', '12');

                        \$('.rowSP\_Ctrl\_5\_10\_10').attr('rowspan', '10');

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '4');

                        \$('.rowSP\_Ctrl\_14\_28\_28').attr('rowspan', '28');

                    \}

                    else if (breakpoint == 'tablet') \{

                        \$('.rowSP\_Ctrl\_0\_2\_2').attr('rowspan', '2');

                        \$('.rowSP\_Ctrl\_6\_12\_12').attr('rowspan', '12');

                        \$('.rowSP\_Ctrl\_5\_10\_10').attr('rowspan', '10');

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '4');

                        \$('.rowSP\_Ctrl\_14\_28\_28').attr('rowspan', '28');

                    \}

                    else if (breakpoint == 'default') \{

                        \$('.rowSP\_Ctrl\_6\_12\_12').attr('rowspan', '6');

                        \$('.rowSP\_Ctrl\_5\_10\_10').attr('rowspan', '5');

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '2');

                        \$('.rowSP\_Ctrl\_14\_28\_28').attr('rowspan', '14');



                        //線條

                        \$(".footable-row-detail").hide();

                    \}



                    if (getBreakPointType\_5types(container\_width) == "phone") \{

                        if ("zh-TW" != "en-US") \{

                            \$('.set-title-L-min-width-class').css("width", "48px");

                        \}

                        else \{

                            \$('.set-title-L-min-width-class').css("width", "90px");

                        \}

                    \} else if (getBreakPointType\_5types(container\_width) == 'tablet') \{

                        \$('.set-title-L-min-width-class').css("max-width", "200px");

                        \$('.set-title-L-min-width-class').css("min-width", "100px");

                    \} else \{

                        \$('.set-title-L-min-width-class').css("max-width", "200px");

                        \$('.set-title-L-min-width-class').css("min-width", "110px");

                    \}



                    //去footable上面多的線\&下面多的線

                    footableHideNodataBottom();



                    // 停用 Row Toggle 功能

                    window.setTimeout(function () \{

                        footable\_off();

                    \}, 1000);

                    \$('.title\_sp').attr('rowspan', '2');

                    \$(".rowSP\_Ctrl\_hidden").hide();

                \});



                // Trigger Event

                \$('.footable').trigger('footable\_breakpoint');



                //resize時改變欄寬

                \$('.footable').bind('footable\_resize', function (e) \{

                    \$('.set-title-L-min-width-class').css("width", "");

                    \$('.set-title-L-min-width-class').css("max-width", "");

                    \$('.set-title-L-min-width-class').css("min-width", "");



                    if (getBreakPointType\_5types(container\_width) == "phone") \{

                        if ("zh-TW" != "en-US") \{

                            \$('.set-title-L-min-width-class').css("width", "48px");

                        \}

                        else \{

                            \$('.set-title-L-min-width-class').css("width", "90px");

                        \}

                    \} else if (getBreakPointType\_5types(container\_width) == 'tablet') \{

                        \$('.set-title-L-min-width-class').css("max-width", "200px");

                        \$('.set-title-L-min-width-class').css("min-width", "100px");

                    \} else \{

                        \$('.set-title-L-min-width-class').css("max-width", "200px");

                        \$('.set-title-L-min-width-class').css("min-width", "110px");

                    \}



                    //去footable上面多的線\&下面多的線

                    footableHideNodataBottom();

                \});





            \}

            if (controller == 'xrt') \{

                \$('.footable').bind('footable\_breakpoint', function (e) \{

                    // 展開所有表格內容

                    \$(this).trigger('footable\_expand\_all');

                    // 依事件動態合併儲存格

                    var breakpoint;

                    if (\$(this).hasClass('phone'))

                        breakpoint = 'phone';

                    else if (\$(this).hasClass('tablet'))

                        breakpoint = 'tablet';

                    else breakpoint = 'default';

                    if (breakpoint == 'phone') \{

                        \$("td[class\^{}='rowSP\_Ctrl\_']").removeAttr('rowspan');

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '4');

                        \$('.rowSP\_Ctrl\_3\_6\_6').attr('rowspan', '6');

                        \$('.rowSP\_Ctrl\_0\_2\_2').attr('rowspan', '2');

                        \$('.rowSP\_Ctrl\_0\_0\_2').attr('rowspan', '2');

                    \}

                    else if (breakpoint == 'tablet') \{

                        \$("td[class\^{}='rowSP\_Ctrl\_']").removeAttr('rowspan');

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '4');

                        \$('.rowSP\_Ctrl\_3\_6\_6').attr('rowspan', '6');

                        \$('.rowSP\_Ctrl\_0\_2\_2').attr('rowspan', '2');

                        \$('.rowSP\_Ctrl\_0\_2\_2').remove

                    \}

                    else if (breakpoint == 'default') \{

                        \$("td[class\^{}='rowSP\_Ctrl\_']").removeAttr('rowspan');

                        \$('.rowSP\_Ctrl\_2\_4\_4').attr('rowspan', '2');

                        \$('.rowSP\_Ctrl\_3\_6\_6').attr('rowspan', '3');



                        //線條

                        \$(".footable-row-detail").hide();

                    \}



                    // 停用 Row Toggle 功能

                    window.setTimeout(function () \{

                        footable\_off();

                    \}, 1000);

                \});



                \$('.rowSP\_Ctrl\_2\_2\_2').attr('rowspan', '2');



                // Trigger Event

                \$('.footable').trigger('footable\_breakpoint');



                var all\_width = \$(".container").width();

                if (all\_width < 720) \{

                    //\$("thead > tr > th").first().css("background-color", "black");

                    \$("thead > tr > th").css("width", all\_width * 0.2 + "px");

                \}

                hideTableTh();



                //xrt/obuhx查詢畫面title等高判定

                setFormTitleHigh();



                //小數尾去0

                removeTableDoubleZero();

            \}



            if (controller == 'home') \{

                \$('.footable').trigger('footable\_expand\_all');

            \}



            if (controller == 'cr') \{

                //cr/手機版rwd表格高調整

                setTableTitleHigh();

            \}



            if (controller == 'use') \{

                //use/手機版rwd表格高調整

                setTableTitleHigh();

            \}



            \$('.footable').footable(\{

                addRowToggle: false

            \});

            flag = false;



            // 查詢功能

            // 單一幣別歷史匯率查詢

            \$("\#single").on("click", function (e) \{

                var action = 'Index';

                var url = action == 'history' ? '/xrt/quote' : '/xrt/obuquote';

                var range = \$('input[name="search\_range"]:checked').val();

                //查詢範圍限前一年度起至最近營業日

                if (range == 'month') \{

                    var Today = new Date();

                    if (\$('select[name=year]').val() > Today.getFullYear() || (\$('select[name=year]').val() >= Today.getFullYear() \&\& \$('select[name=month]').val().replace(/\textbackslash{}b(0+)/gi, "") > parseInt(Today.getMonth()) + 1)) \{

                        if ("".toLowerCase() == "true") \{

                            switch ("zh-TW") \{

                                case "en-US":

                                    alert("The range of specified year-month must be within last 3 year.");

                                    break;

                                case "zh-TW":

                                    alert("指定年月有效範圍為最近三年之內。");

                                    break;

                                case "zh-CN":

                                    alert("指定年月有效范围为最近三年之内。");

                                    break;

                            \}

                        \} else \{

                            switch ("zh-TW") \{

                                case "en-US":

                                    alert("Inquiry Period starts from previous year to the last business day.");

                                    break;

                                case "zh-TW":

                                    alert("查詢範圍限前一年度起至最近營業日。");

                                    break;

                                case "zh-CN":

                                    alert("查询范围限前一年度起至最近营业日。");

                                    break;

                            \}

                        \}

                        return false;

                    \}

                \}



                var cur = \$('select[name=currency]').val();

                var hours = \$('input[name="search\_hours"]:checked').val();

                var type = \$('input[name="rate\_type"]:checked').val();

                if (\$('input[name=obu]').val() == 1) type = "spot";

                var compare = \$('select[name=compare]').is(':enabled') ? \$('select[name=compare]').val() : "";

                // 查詢期間

                if (range == 'day' || range == 'ltm' || range == 'l6m' || range == 'l1y' || range == 'l3y') url += ("/" + range);

                if (range == 'month') url += ("/" + \$('select[name=year]').val() + "-" + \$('select[name=month]').val());

                // 查詢幣別

                url += '/' + (cur ? cur : 'USD');

                url += compare ? "-" + compare : "";

                if (hours == '1') \{

                    url += '/' + type + '/1';

                \} else \{

                    if (type == 'cash') url += '/cash';

                \}

                \$(this).attr('href', url);

            \});



            // 全部幣別歷史匯率查詢

            \$("\#all").on("click", function (e) \{

                var url = '/xrt/all';

                var range = \$('input[name="all\_range"]:checked').val();

                var day = \$('select[name=all\_day]').val();

                // 查詢期間

                if (range == 'day') url += ("/" + range);

                //查詢範圍限前一年度起至最近營業日

                if (range == 'date') \{

                    if (!CheckDate(\$('select[name=all\_year]').val() + "/" + \$('select[name=all\_month]').val().replace(/\textbackslash{}b(0+)/gi, "") + "/" + \$('select[name=all\_day]').val().replace(/\textbackslash{}b(0+)/gi, ""))) \{

                        switch ("zh-TW") \{

                            case "en-US":

                                alert("The historical data is not valid.");

                                break;

                            case "zh-TW":

                                alert("您輸入的歷史資料日期不是一個有效值。");

                                break;

                            case "zh-CN":

                                alert("您输入的历史数据日期不是一个有效值。");

                                break;

                        \}

                        return false;

                    \}

                    var Today = new Date();

                    if (\$('select[name=all\_year]').val() > Today.getFullYear() ||

                        (\$('select[name=all\_year]').val() >= Today.getFullYear() \&\& \$('select[name=all\_month]').val().replace(/\textbackslash{}b(0+)/gi, "") > (parseInt(Today.getMonth()) + 1)) ||

                        (\$('select[name=all\_year]').val() >= Today.getFullYear() \&\& \$('select[name=all\_month]').val().replace(/\textbackslash{}b(0+)/gi, "") >= (parseInt(Today.getMonth()) + 1) \&\& \$('select[name=all\_day]').val().replace(/\textbackslash{}b(0+)/gi, "") > (parseInt(Today.getDate()))) ||

                        \$('select[name=all\_year]').val() < Today.getFullYear() - 3 ||

                        (\$('select[name=all\_year]').val() <= Today.getFullYear() - 3 \&\& \$('select[name=all\_month]').val().replace(/\textbackslash{}b(0+)/gi, "") < (parseInt(Today.getMonth()) + 1)) ||

                        (\$('select[name=all\_year]').val() <= Today.getFullYear() - 3 \&\& \$('select[name=all\_month]').val().replace(/\textbackslash{}b(0+)/gi, "") <= (parseInt(Today.getMonth()) + 1) \&\& \$('select[name=all\_day]').val().replace(/\textbackslash{}b(0+)/gi, "") < (parseInt(Today.getDate())))) \{

                        if ("".toLowerCase() == "true") \{

                            switch ("zh-TW") \{

                                case "en-US":

                                    alert("The range of specified year-month must be within last 3 year.");

                                    break;

                                case "zh-TW":

                                    alert("指定日期有效範圍為最近三年之內。");

                                    break;

                                case "zh-CN":

                                    alert("指定日期有效范围为最近三年之内。");

                                    break;

                            \}

                        \} else \{

                            switch ("zh-TW") \{

                                case "en-US":

                                    alert("Inquiry period starts from previous year to the last business day which Closing Rate had been produced.");

                                    break;

                                case "zh-TW":

                                    alert("查詢範圍限前一年度起至最近一個已產生收盤價之營業日。");

                                    break;

                                case "zh-CN":

                                    alert("查询范围限前一年度起至最近一个已产生收盘价之营业日。");

                                    break;

                            \}

                        \}

                        return false;

                    \}

                \}



                if (range == 'date') url += ("/" + \$('select[name=all\_year]').val() + "-" + \$('select[name=all\_month]').val() + "-" + day);

                if (\$('input[name=obu]').val() == 1) url += '/1';



                \$(this).attr('href', url);

            \});

            \$("\#systemdate").change(function (e) \{

                var r = /\^{}-[0-9]*[1-9][0-9]*\$/;

                if (r.test(getUrlVars()["backtimes"])) \{

                    backtimes = parseInt(getUrlVars()["backtimes"]) - 1;

                \} else \{

                    backtimes = -1;

                \}

                self.location.href = '//' + location.host + location.pathname + "?sysdate=" + \$('select[name=sysdate]').val() + "\&backtimes=" + (backtimes);

            \});



            //最近一個營業日不可比較幣別，比較幣別為空時不顯示現金\&即期

            \$('input:radio[name="search\_range"]').change(function () \{

                //最近一個營業日不可比較幣別，比較幣別為空時不顯示現金\&即期

                search\_range\_check(\$('input:radio:checked[name="search\_range"]'));

            \});



            if (\$("\#ltm").is(":checked") || \$("\#month").is(":checked"))

                \$('select[name=compare]').prop('disabled', false);



            // 匯率種類控制

            \$('select[name=compare]').change(function () \{

                if (\$(this).val()) \{

                    \$('\#datatype').show();

                \} else \{

                    \$('\#datatype').hide();

                \}

            \});

            if (\$('select[name=compare]').val()) \{ \$('\#datatype').show(); \} else \{ \$('\#datatype').hide(); \}



            // 外幣結帳價格表查詢

            \$("\#cr").on("click", function (e) \{

                var Today = new Date();

                if (\$('select[name=year]').val() > Today.getFullYear() ||

                    (\$('select[name=year]').val() >= Today.getFullYear() \&\& \$('select[name=month]').val().replace(/\textbackslash{}b(0+)/gi, "") > (parseInt(Today.getMonth()) + 1))) \{

                    if (controller == 'ir') \{

                        switch ("zh-TW") \{

                            case "en-US":

                                alert("The historical data must be less than or equal to today.");

                                break;

                            case "zh-TW":

                                alert("歷史資料日期不可大於今天。");

                                break;

                            case "zh-CN":

                                alert("历史资料日期不可大于今天。");

                                break;

                        \}

                    \}

                    else \{

                        switch ("zh-TW") \{

                            case "en-US":

                                alert("The selected query date is not date of history data, please select it again");

                                break;

                            case "zh-TW":

                                alert("你輸入之查詢日期非為歷史資料日期");

                                break;

                            case "zh-CN":

                                alert("您输入之查询日期非为历史数据日期");

                                break;

                        \}

                    \}

                    return;

                \}



                var url = '/cr';

                url += ("/" + \$('select[name=year]').val() + "-" + \$('select[name=month]').val());

                \$(this).attr('href', url);

            \});



            // 歷史外匯存款牌告利率查詢 / 新臺幣存(放)款牌告利率查詢

            \$("\#ir").on("click", function (e) \{

                //檢查輸入的日期是否是一個正確的日期格式

                if (\$('select[name=day]').val() != "") \{

                    if (!CheckDate(\$('select[name=year]').val() + "/" + \$('select[name=month]').val().replace(/\textbackslash{}b(0+)/gi, "") + "/" + \$('select[name=day]').val().replace(/\textbackslash{}b(0+)/gi, ""))) \{

                        if (controller == 'ir') \{



                            switch ("zh-TW") \{

                                case "en-US":

                                    alert("The historical data is not valid.");

                                    break;

                                case "zh-TW":

                                    alert("您輸入的歷史資料日期不是一個有效值。");

                                    break;

                                case "zh-CN":

                                    alert("您输入的历史数据日期不是一个有效值。");

                                    break;

                            \}

                        \}

                        else \{

                            switch ("zh-TW") \{

                                case "en-US":

                                    alert("History data query input error");

                                    break;

                                case "zh-TW":

                                    alert("歷史資料查詢輸入錯誤。");

                                    break;

                                case "zh-CN":

                                    alert("历史数据查询输入错误。");

                                    break;

                            \}

                        \}

                        return;

                    \}

                \}

                //查詢範圍限前一年度起至最近營業日

                var Today = new Date();

                if (\$('select[name=year]').val() > Today.getFullYear() ||

                    (\$('select[name=year]').val() >= Today.getFullYear() \&\& \$('select[name=month]').val().replace(/\textbackslash{}b(0+)/gi, "") > (parseInt(Today.getMonth()) + 1)) ||

                    (\$('select[name=year]').val() >= Today.getFullYear() \&\& \$('select[name=month]').val().replace(/\textbackslash{}b(0+)/gi, "") >= (parseInt(Today.getMonth()) + 1) \&\& \$('select[name=day]').val().replace(/\textbackslash{}b(0+)/gi, "") > (parseInt(Today.getDate())))) \{

                    if (controller == 'ir') \{

                        switch ("zh-TW") \{

                            case "en-US":

                                alert("The historical data must be less than or equal to today.");

                                break;

                            case "zh-TW":

                                alert("歷史資料日期不可大於今天。");

                                break;

                            case "zh-CN":

                                alert("历史资料日期不可大于今天。");

                                break;

                        \}

                    \}

                    else \{

                        switch ("zh-TW") \{

                            case "en-US":

                                alert("The selected query date is not date of history data, please select it again");

                                break;

                            case "zh-TW":

                                alert("你輸入之查詢日期非為歷史資料日期");

                                break;

                            case "zh-CN":

                                alert("您输入之查询日期非为历史数据日期");

                                break;

                        \}

                    \}

                    return;

                \} else if (controller == "twd") \{

                    //twd在1998-7-7前沒有值

                    if (\$('select[name=year]').val() < 1988 ||

                    (\$('select[name=year]').val() <= 1988 \&\& \$('select[name=month]').val().replace(/\textbackslash{}b(0+)/gi, "") < (7)) ||

                        (\$('select[name=year]').val() <= 1988 \&\& \$('select[name=month]').val().replace(/\textbackslash{}b(0+)/gi, "") <= (7) \&\& \$('select[name=day]').val().replace(/\textbackslash{}b(0+)/gi, "") < (7))) \{

                        alert("無此歷史資料日期牌告利率可供查詢");

                        return;

                    \}

                \}

                var action = 'Index';

                //var url = controller == 'ir' ? '/ir/history' : '/twd';

                var url = "";

                if (controller == 'ir') \{

                    //url = '/ir/history';

                    url = action == 'history' ? '/ir/history' : '/ir/obuhx';

                \} else \{

                    url = '/twd';

                \}

                url += ("/" + \$('select[name=year]').val() + "-" + \$('select[name=month]').val() + "-" + \$('select[name=day]').val());

                \$(this).attr('href', url);

            \});



            // 歷史黃金牌價查詢

            \$("\#gold").on("click", function (e) \{

                var range = \$('input[name="search\_range"]:checked').val();

                //查詢範圍限前一年度起至最近營業日

                if (range == 'date') \{

                    var Today = new Date();

                    if (!CheckDate(\$('select[name=year]').val() + "/" + \$('select[name=month]').val().replace(/\textbackslash{}b(0+)/gi, "") + "/" + \$('select[name=day]').val().replace(/\textbackslash{}b(0+)/gi, ""))) \{

                        switch ("zh-TW") \{

                            case "en-US":

                                alert("The specified date is not valid.");

                                break;

                            case "zh-TW":

                                alert("指定日期是一個無效值。");

                                break;

                            case "zh-CN":

                                alert("指定日期是一个无效值。");

                                break;

                        \}

                        return;

                    \}

                    if (\$('select[name=year]').val() > Today.getFullYear() ||

                    (\$('select[name=year]').val() >= Today.getFullYear() \&\& \$('select[name=month]').val().replace(/\textbackslash{}b(0+)/gi, "") > (parseInt(Today.getMonth()) + 1)) ||

                    (\$('select[name=year]').val() >= Today.getFullYear() \&\& \$('select[name=month]').val().replace(/\textbackslash{}b(0+)/gi, "") >= (parseInt(Today.getMonth()) + 1) \&\& \$('select[name=day]').val().replace(/\textbackslash{}b(0+)/gi, "") > (parseInt(Today.getDate())))) \{

                        switch ("zh-TW") \{

                            case "en-US":

                                alert("The historical data is not valid.");

                                break;

                            case "zh-TW":

                                alert("您輸入的歷史資料日期不是一個有效值。");

                                break;

                            case "zh-CN":

                                alert("您输入的历史数据日期不是一个有效值。");

                                break;

                        \}

                        return;

                    \}

                \}

                var url = '/gold/quote';

                // 查詢期間

                if (range == 'recent' || range == 'preceding') url += ("/" + range);

                if (range == 'date') url += ("/" + \$('select[name=year]').val() + "-" + \$('select[name=month]').val() + "-" + \$('select[name=day]').val());

                \$(this).attr('href', url);

            \});

            // 歷史黃金存摺牌價查詢

            \$("\#passbook").on("click", function (e) \{

                // 基本變數

                var url = '/gold/chart';

                var range = \$('input[name="search\_range"]:checked').val();

                var cur = \$('select[name=currency]').val();

                var hours = \$('input[name="search\_hours"]:checked').val();

                //查詢範圍限前一年度起至最近營業日

                var Today = new Date();

                if (\$('select[name=year]').val() > Today.getFullYear() ||

                    (\$('select[name=year]').val() >= Today.getFullYear() \&\& \$('select[name=month]').val().replace(/\textbackslash{}b(0+)/gi, "") > (parseInt(Today.getMonth()) + 1))) \{

                    if (range == "date") \{

                        if ("".toLowerCase() == "true") \{

                            switch ("zh-TW") \{

                                case "en-US":

                                    alert("The range of specified year-month must be within last 3 year.");

                                    break;

                                case "zh-TW":

                                    alert("指定年月有效範圍為最近三年之內。");

                                    break;

                                case "zh-CN":

                                    alert("指定年月有效范围为最近三年之内。");

                                    break;

                            \}

                        \} else \{

                            switch ("zh-TW") \{

                                case "en-US":

                                    alert("The range of specified year-month must be within last 1 year.");

                                    break;

                                case "zh-TW":

                                    alert("指定年月有效範圍為最近一年之內。");

                                    break;

                                case "zh-CN":

                                    alert("指定年月有效范围为最近一年之内。");

                                    break;

                            \}

                        \}

                        return;

                    \}

                \}



                // 查詢期間

                if (range == 'day' || range == 'ltm' || range == 'half' || range == 'year' || range == 'l3y') url += ("/" + range);

                if (range == 'date') url += ("/" + \$('select[name=year]').val() + "-" + \$('select[name=month]').val());

                // 查詢幣別

                url += '/' + (cur ? cur : 'USD');

                // 查詢項目

                if (hours == '1') \{

                    url += '/1';

                \}

                \$(this).attr('href', url);

            \});

            \$("\#bias").on("click", function (e) \{

                var url = '/bias/chart';

                var range = \$('input[name="date"]:checked').val();

                \$(this).attr('href', url + "/" + range);

            \});



            //RWD加入千分位

            tableAddCommafy();



            \$(".footable-row-detail-value").each(function () \{

                var td = \$(this).text();

                if (!isNaN(td)) \{

                    if (td.split(".").length == 1) \{

                        \$(this).text(commafy(td));

                    \} else if (td.split(".").length == 2) \{

                        //小數部份不用加千分位

                        \$(this).text(commafy(td.split(".")[0]) + "." + td.split(".")[1]);

                    \}

                \}

            \})



            //多語系下拉顯示文字(依現行語系顯示)

            //電腦版下拉

            \$('\#lang\_ddl')

                .find('option')

                .filter(function () \{

                    return this.value == "zh-TW";

                \})

                .prop('selected', true);



            //手機版下拉

            switch ("zh-TW") \{

                case "en-US":

                    \$("\#lang\_ddl\_phone").html("En");

                    break;

                case "zh-TW":

                    \$("\#lang\_ddl\_phone").html("中");

                    break;

                case "zh-CN":

                    \$("\#lang\_ddl\_phone").html("简");

                    break;

            \}



            //電腦版多語系

            \$("\#lang\_ddl").change(function () \{

                ChangeLanguage(\$(this).val());

            \})



            //手機版多語系

            \$(".lang\_ddl\_css").click(function () \{

                ChangeLanguage(\$(this).attr("value"));

            \})



            \$(".click\_print").on("click", function (e) \{

                if (!-[1, ]) \{

                    //IE8

                    //wb.execwb(7, 1);

                    if (location.search == "") \{

                        window.open(location.pathname + "?page=print", 'Print');

                    \} else \{

                        //window.open(location.pathname + "?page=print\&" + location.search.replace("?", ""), 'Print');

                        setPrintStyle();

                    \}

                \}

                else \{

                    if (detectBrowser() == "IE") \{

                        //IE9\textasciitilde{}11

                        //wb.execwb(7, 1);

                        if (location.search == "") \{

                            window.open(location.pathname + "?page=print", 'Print');

                        \} else \{

                            //window.open(location.pathname + "?page=print\&" + location.search.replace("?", ""), 'Print');

                            setPrintStyle();

                        \}

                    \}

                    else if (detectBrowser() == "Firefox") \{

                        //Firefox

                        //window.print();

                        if (location.search == "") \{

                            window.open(location.pathname + "?page=print", 'Print');

                        \} else \{

                            //window.open(location.pathname + "?page=print\&" + location.search.replace("?", ""), 'Print');

                            setPrintStyle();

                        \}

                    \}

                    else \{

                        window.print();

                    \}

                \}

            \});

            \$(".doPrintBtn").on("click", function () \{

                window.print();

            \})

            \$(".doCloseBtn").on("click", function () \{

                window.close();

            \})



            //判斷列印頁 \& 加上列印style

            var location\_search = location.search;

            if (location\_search.split("page=print").length > 1) \{

                setPrintStyle();

            \}



            var backtimes = -1;

            //自定上一頁

            \$(".click\_back").on("click", function (e) \{

                var r = /\^{}-[0-9]*[1-9][0-9]*\$/;

                if (r.test(getUrlVars()["backtimes"])) \{

                    backtimes = parseInt(getUrlVars()["backtimes"]) - 1;

                \} else \{

                    backtimes = -1;

                \}

                window.history.go(backtimes);

                return false;

            \});



            \$(".click\_back\_times").on("click", function (e) \{

            \});



            \$(".click\_close").on("click", function (e) \{

                window.close();

            \});



            //class多語系顯示控制

            \$(".zh-TW\_show").hide();

            switch ("zh-TW") \{

                case "en-US":

                    //\$(".zh-TW\_show").css("display", "none !important");

                    \$(".zh-TW\_show").hide();

                    //\$(".zh-CN\_show").css("display", "none !important");

                    \$(".zh-CN\_show").hide();

                    \$(".en-US\_show").show();

                    break;

                case "zh-TW":

                    //\$(".zh-CN\_show").css("display", "none !important");

                    \$(".zh-CN\_show").hide();

                    //\$(".zh-US\_show").css("display", "none !important");

                    \$(".en-US\_show").hide();

                    \$(".zh-TW\_show").show();

                    break;

                case "zh-CN":

                    //\$(".zh-TW\_show").css("display", "none !important");

                    \$(".zh-TW\_show").hide();

                    //\$(".zh-US\_show").css("display", "none !important");

                    \$(".en-US\_show").hide();

                    \$(".zh-CN\_show").show();

                    break;

            \}



            //比較幣別 防呆xrt/history xrt/obuhx 不可比較自己

            onCurrencySelectChange();



            //補history查詢lable改div後點文字無法自動選擇

            //單一幣別

            \$(".click\_select\_month").click(function () \{

                \$("\#month").prop("checked", true);

                //最近一個營業日不可比較幣別，比較幣別為空時不顯示現金\&即期

                search\_range\_check(\$('input:radio:checked[name="search\_range"]'));

            \})

            //比較幣別

            \$(".click\_select\_date").click(function () \{

                \$("\#input\_date").prop("checked", true);

            \})



            //右上角切換語言鍵，改為點選開關

            \$("\#lang\_ddl\_phone").click(function () \{

                //alert(\$(".dropdown-content").css("display"));

                if (\$(".dropdown-content").css("display") == "none") \{

                    \$(".dropdown-content").show();

                    \$(this).css("background-color", "white");

                    \$(this).css("color", "\#8a0050");

                \} else \{

                    \$(".dropdown-content").hide();

                    \$(this).css("background-color", "black");

                    \$(this).css("color", "white");

                \}

            \})



            //footable 展開所有表格內容

            \$(".click\_ExpandAll").click(function () \{

                \$('.footable').trigger('footable\_expand\_all');

            \})



            //footable 關閉所有表格內容

            \$(".click\_CollapseAll").click(function () \{

                \$('.footable').trigger('footable\_collapse\_all');

            \})



            //取得最新xx

            \$(".click\_reload").on("click", function (e) \{

                location.reload();

            \});

            

        \});



        \$(window).load(function () \{

            //最近一個營業日不可比較幣別，比較幣別為空時不顯示現金\&即期(for chrome)

            search\_range\_check(\$('input:radio:checked[name="search\_range"]'));

            //alert("load");

        \})

    </script>

</body>

</html>

    \end{Verbatim}

    \subsection{利用pandas库来爬取网页的数据}\label{ux5229ux7528pandasux5e93ux6765ux722cux53d6ux7f51ux9875ux7684ux6570ux636e}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{c+c1}{\PYZsh{} improt pandas module}
         \PY{k+kn}{import} \PY{n+nn}{pandas}
         \PY{c+c1}{\PYZsh{} read html to transform html to list of python}
         \PY{n}{dfs} \PY{o}{=} \PY{n}{pandas}\PY{o}{.}\PY{n}{read\PYZus{}html}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{http://rate.bot.com.tw/xrt?Lang=zh\PYZhy{}TW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{dfs}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}47}]:} list
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{dfs}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}48}]:} 1
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{c+c1}{\PYZsh{} dfs is list}
         \PY{c+c1}{\PYZsh{} currency is DataFrame}
         \PY{n}{currency} \PY{o}{=} \PY{n}{dfs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{currency}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}50}]:} pandas.core.frame.DataFrame
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{c+c1}{\PYZsh{} currency.ix[row, columnns]}
         \PY{n}{currency} \PY{o}{=} \PY{n}{currency}\PY{o}{.}\PY{n}{ix}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{c+c1}{\PYZsh{} 重置列标题}
         \PY{n}{currency}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{u\PYZsq{}}\PY{l+s+s1}{幣別}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{u\PYZsq{}}\PY{l+s+s1}{現金匯率\PYZhy{}本行買入}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{u\PYZsq{}}\PY{l+s+s1}{現金匯率\PYZhy{}本行賣出}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{u\PYZsq{}}\PY{l+s+s1}{即期匯率\PYZhy{}本行買入}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{u\PYZsq{}}\PY{l+s+s1}{即期匯率\PYZhy{}本行賣出}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{c+c1}{\PYZsh{} 正则表达式 提取币别}
         \PY{n}{currency}\PY{p}{[}\PY{l+s+s1}{u\PYZsq{}}\PY{l+s+s1}{幣別}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{currency}\PY{p}{[}\PY{l+s+s1}{u\PYZsq{}}\PY{l+s+s1}{幣別}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{extract}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{((}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{w+)}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} \PYZbs{}((\PYZbs{}w+)\PYZbs{})}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}Administrator\textbackslash{}Anaconda2\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\textbackslash{}\_\_main\_\_.py:1: FutureWarning: currently extract(expand=None) means expand=False (return Index/Series/DataFrame) but in a future version of pandas this will be changed to expand=True (return DataFrame)
  if \_\_name\_\_ == '\_\_main\_\_':

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{n}{currency}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}54}]:}      幣別 現金匯率-本行買入 現金匯率-本行賣出 即期匯率-本行買入 即期匯率-本行賣出
         0   USD     31.18    31.722     31.48     31.58
         1   HKD     3.914     4.109     4.034     4.094
         2   GBP     37.82     39.75     38.69     39.11
         3   AUD     23.53     24.19     23.72     23.95
         4   CAD     23.34     24.08     23.61     23.83
         5   SGD     21.62      22.4     22.04     22.22
         6   CHF     30.68     31.74     31.21      31.5
         7   JPY    0.2664    0.2774    0.2728    0.2768
         8   ZAR         -         -      2.29      2.37
         9   SEK      3.14      3.65      3.48      3.58
         10  NZD     22.34     22.97     22.58     22.78
         11  THB    0.7886    0.9316    0.8771    0.9171
         12  PHP    0.5826    0.7156         -         -
         13  IDR   0.00198   0.00268         -         -
         14  EUR     32.96     34.11     33.46     33.86
         15  KRW   0.02518   0.02908         -         -
         16  VND   0.00102   0.00152         -         -
         17  MYR     6.006     7.606         -         -
         18  CNY      4.51     4.672     4.582     4.632
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{c+c1}{\PYZsh{} save currency to excel form }
         \PY{n}{currency}\PY{o}{.}\PY{n}{to\PYZus{}excel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{currency.xlsx}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
